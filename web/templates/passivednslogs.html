<!DOCTYPE html>
<html>
<head>
    <title>Passive DNS</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h6>Query: </h6>
                {{.Query}}
                <small class="text-right">max 5000 results</small>
            </div>
        </div>
        <div class="row">
            <form hx-get="/passivedns" hx-target="#content1" class="needs-validation" novalidate>
                <div class="row g-3">
                    <div class="col-md-9">
                        <div class="mb-3">
                            <label for="qname" class="form-label">Query by Name</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-sm" id="qname" name="qname" placeholder="Enter domain (e.g., msn.com)" required>
                                <div class="invalid-feedback">
                                    Please enter a valid domain name.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="rdata" class="form-label">Query by Data</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-sm" id="rdata" name="rdata" placeholder="Enter IP or data (e.g., 8.8.8.8)" required>
                                <div class="invalid-feedback">
                                    Please enter a valid IP.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 d-flex align-items-center">
                        <button type="submit" class="btn btn-primary custom-large-btn">Query</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="row">
            <div class="col-12">
                <div id="table-responsive">
                    <table class="table table-striped table-sm sortable">
                        <thead>
                            <tr>
                                <th>First Seen</th>
                                <th>Last Seen</th>
                                <th>Qname</th>
                                <th>Domain</th>
                                <th>Domain Suffix</th>            
                                <th>RName</th>
                                <th>RType</th>
                                <th>TTL</th>
                                <th>RData</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{range .Records}}
                            <tr>
                                <td>{{.FirstSeen}}</td>
                                <td>{{.LastSeen}}</td>
                                <td>{{.Qname}}</td>
                                <td>{{.Domain}}</td>
                                <td>{{.DomainSuffix}}</td>            
                                <td>{{.RName}}</td>
                                <td>{{.RType}}</td>
                                <td>{{.TTL}}</td>
                                <td>{{.RData}}</td>
                                <td>{{.Count}}</td>
                            </tr>
                            {{end}}
                        </tbody>
                    </table>
                </div>  
            </div>
        </div>
    </div>
</body>
</html>